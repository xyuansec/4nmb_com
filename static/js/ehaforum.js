function fastcomment(a,b){if(b.length<5||b.length>5e3)return alertmsg("确保内容至少6个字符！"),!1;var c=new FormData;c.append("content",b),$.ajax({type:"POST",dataType:"json",url:"/fastcomment/"+a,data:c,processData:!1,contentType:!1,beforeSend:function(a){a.setRequestHeader("X-CSRFToken",$.cookie("csrftoken"))},success:function(a){0===a["code"]?alertmsg(a["msg"]):(alertmsg(a["msg"]),window.location.reload())},error:function(){}})}function switchnav(){nav_collapse=$(".navbar-collapse"),content_box=$("#content-box"),navbar_vertical=$(".navbar-vertical"),$(nav_collapse).hasClass("resize")?(localStorage.setItem("nav_resize",!1),$(nav_collapse).removeClass("resize"),$(window).width()<=1199?$(nav_collapse).removeClass("navicon-show"):($(".navbar-card").css("right","-12px"),$(nav_collapse).css({cssText:"display:flex!important"}),$(".pr-lg-2.mb-3.col-lg-8").css("z-index","0")),$(content_box).addClass("content"),$(navbar_vertical).css("z-index","1026")):(localStorage.setItem("nav_resize",!0),$(nav_collapse).addClass("resize"),$(window).width()<=1199?$(nav_collapse).addClass("navicon-show"):($(".navbar-card").css("right","0"),$(nav_collapse).css({cssText:"display:none!important"}),$(".pr-lg-2.mb-3.col-lg-8").css("z-index","1017")),$(content_box).removeClass("content"),$(navbar_vertical).css("z-index","1029"))}function tologin(){$(".publish").hide(),$(".comment").hide(),$(".register").hide(),$(".login").css("display","block")}function toregister(){$(".publish").hide(),$(".login").hide(),$(".register").css("display","block")}function login(){var a,b,c;return login_submit=$(".login-submit"),error_msg=$(".error_msg"),$(login_submit).text("等待中..."),$(error_msg).text(""),a=$(".login-name").val(),b=$(".login-passwd").val(),a.length<5||a.length>15||b.length<5||b.length>15?($(error_msg).text("（应在6到15字符之间！）"),$(login_submit).text("提交!"),!1):(c=new FormData,c.append("name",a),c.append("passwd",b),$(login_submit).attr("disabled",!0),$.ajax({type:"POST",dataType:"json",url:"/login/",data:c,processData:!1,contentType:!1,beforeSend:function(a){a.setRequestHeader("X-CSRFToken",$.cookie("csrftoken"))},success:function(a){0===a["code"]?$(".error_msg").text("（"+a["msg"]+"）"):($(".login-submit").text("成功!"),$(".error_msg").text(""),window.location.reload()),$(login_submit).text("提交!"),$(login_submit).attr("disabled",!1)},error:function(){}}),void 0)}function publish(){var a,b,c,d,e;return publish_submit=$(".publish-submit"),error_msg=$(".error_msg"),$(publish_submit).text("等待中..."),$(error_msg).text(""),a=$(".publish-content").val(),b=$(".publish-image")[0].files[0],c=$(".publish-category").val(),d=$(".publish-rewardnb").val(),a.length<5||a.length>5e4?($(error_msg).text("（确保内容至少6个字符！）"),$(publish_submit).text("发射!"),!1):(e=new FormData,e.append("content",a),e.append("image",b),e.append("category",c),e.append("rewardnb",d),$(publish_submit).attr("disabled",!0),$.ajax({type:"POST",dataType:"json",url:"/publish/",data:e,processData:!1,contentType:!1,beforeSend:function(a){a.setRequestHeader("X-CSRFToken",$.cookie("csrftoken"))},success:function(a){0===a["code"]?$(".error_msg").text("（"+a["msg"]+"）"):(alertmsg(a["msg"]),window.location.reload()),$(publish_submit).text("发射!"),$(publish_submit).attr("disabled",!1)},error:function(){}}),void 0)}function pbmarket(){var a,b,c,d,e,f,g,h,i;return pbmarket_submit=$(".pbmarket-submit"),error_msg=$(".error_msg"),$(pbmarket_submit).text("等待中..."),$(error_msg).text(""),a=$("#mktitle").val(),b=$("#mkcatgr").val(),c=$("#mkprice").val(),d=$("#mkstock").val(),e=$("#mkdescp").val(),f=$("#mkhiden").val(),g=$("#mkphoto")[0].files[0],h=$("#mkcontact").val(),a.length<5||a.length>60?(alertmsg("商品标题请填写5到60个字符之间！"),$(pbmarket_submit).text("点击发布商品!"),!1):e.length<20?(alertmsg("请认真填写商品的描述信息！"),$(pbmarket_submit).text("点击发布商品!"),!1):f.length<5?(alertmsg("请认真填写商品的隐藏内容！"),$(pbmarket_submit).text("点击发布商品!"),!1):(i=new FormData,i.append("mktitle",a),i.append("mkcatgr",b),i.append("mkprice",c),i.append("mkstock",d),i.append("mkdescp",e),i.append("mkhiden",f),i.append("mkphoto",g),i.append("mkcontact",h),$(pbmarket_submit).attr("disabled",!0),$.ajax({type:"POST",dataType:"json",url:"/pbmarket2/",data:i,processData:!1,contentType:!1,beforeSend:function(a){a.setRequestHeader("X-CSRFToken",$.cookie("csrftoken"))},success:function(a){0===a["code"]?(alertmsg(a["msg"]),$(".error_msg").text("（"+a["msg"]+"）")):(alertmsg(a["msg"]),window.location.href="/market"),$(pbmarket_submit).text("点击发布商品!"),$(pbmarket_submit).attr("disabled",!1)},error:function(){}}),void 0)}function edmarket(a){var b,c,d,e,f,g,h,i,j,k;return edmarket_submit=$(".edmarket-submit"),b=$(a).attr("data-id"),error_msg=$(".error_msg"),$(edmarket_submit).text("等待中..."),$(error_msg).text(""),c=$("#mktitle").val(),d=$("#mkcatgr").val(),e=$("#mkprice").val(),f=$("#mkstock").val(),g=$("#mkdescp").val(),h=$("#mkhiden").val(),i=$("#mkphoto")[0].files[0],j=$("#mkcontact").val(),c.length<5||c.length>60?(alertmsg("商品标题请填写5到60个字符之间！"),$(edmarket_submit).text("点击发布商品!"),!1):g.length<20?(alertmsg("请认真填写商品的描述信息！"),$(edmarket_submit).text("点击发布商品!"),!1):h.length<5?(alertmsg("请认真填写商品的隐藏内容！"),$(edmarket_submit).text("点击发布商品!"),!1):(k=new FormData,k.append("mktitle",c),k.append("mkcatgr",d),k.append("mkprice",e),k.append("mkstock",f),k.append("mkdescp",g),k.append("mkhiden",h),k.append("mkphoto",i),k.append("mkcontact",j),$(edmarket_submit).attr("disabled",!0),$.ajax({type:"POST",dataType:"json",url:"/mkediter2/"+b,data:k,processData:!1,contentType:!1,beforeSend:function(a){a.setRequestHeader("X-CSRFToken",$.cookie("csrftoken"))},success:function(a){0===a["code"]?(alertmsg(a["msg"]),$(".error_msg").text("（"+a["msg"]+"）")):(alertmsg(a["msg"]),window.location.href="/market/"+b),$(edmarket_submit).text("点击更新商品!"),$(edmarket_submit).attr("disabled",!1)},error:function(){}}),void 0)}function paymarket(a){var b=$(a).attr("data-id");$(a).text("校验中..."),$(a).attr("disabled",!0),$.ajax({type:"GET",dataType:"json",url:"/paymarket/"+b,success:function(a){0===a["code"]?(alertmsg(a["msg"]),$(".error_msg").text("（"+a["msg"]+"）")):(alertmsg(a["msg"]),window.location.reload())},error:function(){}})}function comment(){var a,b,c,d,e;return comment_submit=$(".comment-submit"),error_msg=$(".error_msg"),$(comment_submit).text("等待中..."),$(error_msg).text(""),a=$(".comment-content").val(),b=$("#comment-parentid").val(),c=$(".comment-image")[0].files[0],d=$(comment_submit).attr("data-thread"),a.length<5||a.length>5e3?($(error_msg).text("（确保内容至少6个字符！）"),$(comment_submit).text("回复!"),!1):(e=new FormData,e.append("content",a),e.append("parentid",b),e.append("image",c),$(comment_submit).attr("disabled",!0),$.ajax({type:"POST",dataType:"json",url:"/comment/"+d,data:e,processData:!1,contentType:!1,beforeSend:function(a){a.setRequestHeader("X-CSRFToken",$.cookie("csrftoken"))},success:function(a){0===a["code"]?$(".error_msg").text("（"+a["msg"]+"）"):(alertmsg(a["msg"]),window.location.reload()),$(comment_submit).text("回复!"),$(comment_submit).attr("disabled",!1)},error:function(){}}),void 0)}function alertmsg(a){$("#message .modal-body").text(a),$("#message").modal()}function good(a){var b=$(a).attr("data-id"),c=$(a).attr("data-type");$.ajax({type:"GET",dataType:"json",url:"/good/"+c+"/"+b,success:function(b){0===b["code"]?alertmsg(b["msg"]):(likenumb=$(a).find(".likenumb").text(),$(a).find(".likenumb").text(parseInt(likenumb)+1+"")),$(".comment-submit").text("发射!")},error:function(){}})}function reply(a){obj=$(".comment"),comment_content=$(".comment-content"),$(obj).removeClass("resize"),$(obj).find(".card-footer").show(),$(obj).find(".card-body").show(),nickname=$(a).attr("data-author"),commid=$(a).attr("data-commid"),$(comment_content).attr("placeholder","@"+nickname+" "),$("#comment-parentid").val(commid)}function signpoint(){$.ajax({type:"get",dataType:"json",url:"/signpoint/",success:function(a){alertmsg(a["msg"])},error:function(){}})}function register(){var a,b,c,d;return register_submit=$(".register-submit"),error_msg=$(".error_msg"),$(register_submit).text("等待中..."),$(error_msg).text(""),a=$(".register-name").val(),b=$(".register-email").val(),c=$(".register-passwd").val(),a.length<5||a.length>15||c.length<5||c.length>15?($(error_msg).text("（数据填写错误！）"),$(register_submit).text("提交!"),!1):(d=new FormData,d.append("name",a),d.append("email",b),d.append("passwd",c),$(register_submit).attr("disabled",!0),$.ajax({type:"POST",dataType:"json",url:"/register/",data:d,processData:!1,contentType:!1,beforeSend:function(a){a.setRequestHeader("X-CSRFToken",$.cookie("csrftoken"))},success:function(a){0===a["code"]?$(".error_msg").text("（"+a["msg"]+"）"):($(".register-submit").text("成功!"),$(".error_msg").text(""),window.location.reload()),$(register_submit).text("提交!"),$(register_submit).attr("disabled",!1)},error:function(){}}),void 0)}function setgodcomment(a){confirm("是否确认盖上神评论？")&&(threadid=$(a).attr("data-threadid"),commentid=$(a).attr("data-commentid"),$.ajax({type:"get",dataType:"json",url:"/setgodcomment/"+threadid+"/"+commentid,success:function(){window.location.reload()},error:function(){}}))}function setrecvemail(){recvflag=$("#email-isrecv").attr("data-recvflag"),$.ajax({type:"get",dataType:"json",url:"/setrecvemail/"+recvflag,success:function(){window.location.reload()},error:function(){}})}function setlocation(){locatflag=$("#locat-isopen").attr("data-locatflag"),$.ajax({type:"get",dataType:"json",url:"/setlocation/"+locatflag,success:function(){window.location.reload()},error:function(){}})}function resizewindow(){obj=$(".card-box"),$(obj).hasClass("resize")?($(obj).removeClass("resize"),$(obj).find(".card-footer").show(),$(obj).find(".card-body").show()):($(obj).addClass("resize"),$(obj).find(".card-footer").hide(),$(obj).find(".card-body").hide())}function setzuijiacomment(a){confirm("是否确认为最佳答案？")&&(threadid=$(a).attr("data-threadid"),commentid=$(a).attr("data-commentid"),$.ajax({type:"get",dataType:"json",url:"/setzuijiacom/"+threadid+"/"+commentid,success:function(){window.location.reload()},error:function(){}}))}function feelingswitch(){feeling_body=$(".feelings-body"),$(feeling_body).hasClass("resize")?($(feeling_body).removeClass("resize"),$(feeling_body).hide()):($(feeling_body).addClass("resize"),$(feeling_body).show())}function update(){var a,b,c,d;return update_submit=$(".update-submit"),error_msg=$(".error_msg"),$(update_submit).text("等待中..."),$(error_msg).text(""),a=$(".update-content").val(),b=$(".update-image")[0].files[0],c=$(update_submit).attr("data-threadid"),a.length<5||a.length>5e4?($(error_msg).text("（确保内容至少6个字符！）"),$(update_submit).text("提交!"),!1):(d=new FormData,d.append("content",a),d.append("image",b),d.append("threadid",c),$(update_submit).attr("disabled",!0),$.ajax({type:"POST",dataType:"json",url:"/update/",data:d,processData:!1,contentType:!1,beforeSend:function(a){a.setRequestHeader("X-CSRFToken",$.cookie("csrftoken"))},success:function(a){0===a["code"]?$(".error_msg").text("（"+a["msg"]+"）"):window.location.reload(),$(update_submit).text("提交!"),$(update_submit).attr("disabled",!1)},error:function(){}}),void 0)}function toupdate(){$(".comment").hide(),$(".update").show()}function generacode(a){threadid=$(a).attr("data-threadid"),void 0!==threadid&&$.ajax({type:"get",dataType:"json",url:"/generacode/"+threadid,success:function(a){0===a["code"]?alertmsg(a["msg"]):($("#message .modal-body").html("<img src='"+a["msg"]+"' style='width:100%;height:100%' />"),$("#message").modal())},error:function(){}})}function updateprofile(){var a,b,c,d,e,f,g;profile_submit=$(".profile-submit"),error_msg=$(".error_msg"),$(profile_submit).text("等待中..."),$(error_msg).text(""),a=$("#profile-name").val(),b=$("#profile-email").val(),c=$("#profile-avator")[0].files[0],d=$("#profile-mysite").val(),e=$("#profile-passwd").val(),f=$("#profile-whatdoth").val(),g=new FormData,g.append("name",a),g.append("email",b),g.append("avator",c),g.append("mysite",d),g.append("passwd",e),g.append("whatdoth",f),$.ajax({type:"POST",dataType:"json",url:"/uprofile/",data:g,processData:!1,contentType:!1,beforeSend:function(a){a.setRequestHeader("X-CSRFToken",$.cookie("csrftoken"))},success:function(a){0===a["code"]?$(".error_msg").text("（"+a["msg"]+"）"):window.location.reload(),$(".profile-submit").text("更新资料!")},error:function(){}})}function shareqq(a){var d,e,b={url:$(a).attr("data-url"),summary:$(a).attr("data-content"),pics:$(a).attr("data-pic")},c=[];for(d in b)c.push(d+"="+encodeURIComponent(b[d]||""));e="https://connect.qq.com/widget/shareqq/index.html?"+c.join("&"),window.open(e,"qq")}function setniminswh(){niminflag=$("#niminswh-isopen").attr("data-niminflag"),$.ajax({type:"get",dataType:"json",url:"/setniminswh/"+niminflag,success:function(){window.location.reload()},error:function(){}})}function sendactive(){var a=$("#sendactive");a.unbind("click"),a.text("发送中..."),$.ajax({type:"GET",dataType:"json",url:"/active",success:function(b){alertmsg(b["msg"]),a.text("发送完毕！")},error:function(){}})}function videosearch(){var a=$("#videosearchcontent").val();return 0===a.length?(alertmsg("不能为空"),void 0):(location.href="/cinema/search/?content="+a,void 0)}$(document).ready(function(){function d(){var a=this;[].forEach.call(c,function(b){b!==a&&b.pause()})}var a=0,b=0,c=document.getElementsByTagName("audio");null!==document.getElementById("top-view")&&(a=document.getElementById("top-view").offsetTop,b=document.getElementById("top-view").offsetHeight),[].forEach.call(c,function(a){a.addEventListener("play",d.bind(a))}),$(window).width()>1199&&"true"===localStorage.getItem("nav_resize")&&switchnav(),$(".gifs").gifplayer({label:"&#x25b7;"}),$("#gototop").hide(),$(window).scroll(function(){(0!==a||0!==b)&&$(window).scrollTop()>a?($(".fixed-ad").css("position","sticky"),$(".fixed-ad").css("top","72px"),$(".fixed-ad .card-body").css("padding-left","12px"),$(".fixed-ad .card-body").css("padding-right","12px")):($(".fixed-ad").css("position","static"),$(".fixed-ad").css("top","0")),$(window).scrollTop()>300?$("#gototop").fadeIn("slow"):$("#gototop").hide()}),$("#gototop").click(function(){$("html,body").animate({scrollTop:0})}),$(".thread-list img").click(function(){-1==$(this).attr("class").indexOf("gifs")&&(void 0===$(this).attr("data-big")||"false"===$(this).attr("data-big")?(tempsrc=$(this).attr("src"),$(this).attr("src",tempsrc.split(".")[0]+"_source."+tempsrc.split(".")[1]),$(this).css("cursor","zoom-out"),$(this).addClass("maxwidth"),$(this).attr("data-big","true")):(tempsrc=$(this).attr("src"),$(this).attr("src",tempsrc.replace("_source","")),$(this).css("cursor","zoom-in"),$(this).removeClass("maxwidth"),$(this).attr("data-big","false")))}),$(".feelings-body ul li").click(function(a){textarea_feel=$(".textarea-feel");var b=$(textarea_feel).val();b+=$(a.target).html(),$(textarea_feel).val(b)}),$(".fastcomment").keypress(function(a){13===a.which&&fastcomment($(this).attr("data-id"),$(this).val())}),$(".insertsomelink").children().click(function(){var a=$(".publish textarea");0===$(this).index()?a.val(a.val()+"[video]视频链接#sp#正文内容[/video]\r\nps：需要封面请把链接改成 -> xxx.mp4|封面地址"):1===$(this).index()?a.val(a.val()+"[audio]音乐链接#sp#正文内容[/audio]"):2===$(this).index()?a.val(a.val()+"[markdown]文章标题#sp#正文内容[/markdown]"):3===$(this).index()&&a.val(a.val()+"[bilibili]分享代码#sp#正文内容[/bilibili]")})});